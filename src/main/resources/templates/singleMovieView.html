<!DOCTYPE html>
<html layout:decorate="~{layouts/layout}">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GoodWatch</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="" th:href="@{/css/reset.css}">
    <link rel="stylesheet" th:href="@{/css/singleMovieView.css}" href="">
</head>
<body>

    <div layout:fragment="content">
      
        <div class="movie-container d-flex flex-wrap">
            <img class="poster" th:src="@{${'/images/' + movie.poster}}">
            <div class="movie-info w-50 ms-5 d-flex flex-column">
                <h2 class="mb-4 pb-2 mb-3 border-bottom" th:text="${movie.title}">Title</h2>

               
                <a class="movie-director mb-3" th:href="@{${'/director/' + movie.director.directorID + '/movies'}}" th:text="${movie.director.name}"></a>
                <p class="movie-rt mb-3"><span th:text="${movie.runtime}">Runtime</span> minutes</p>
                <p class="movie-year mb-3" th:text="${movie.releaseYear}">releaseYear</p>
                <p class="movie-rating mb-3" th:text="${movie.getAvgRating()}">Rating</p>
               
                

                <div class="movie-genres mt-3">
                    <p th:each="genre : ${movie.genres}" class="d-inline-flex me-2 text-muted" th:text="${genre.label}">Genres</p>
                </div>
                
                <p class="mt-2 pt-3 border-top" th:text="${movie.plot}">Plot</p>
                <a href="#" th:unless="${movie.watched}" th:href="@{${'/user/addMovie/' + movie.movieID}}" class="btn btn-success mt-3 movie-btn">+ Watched</a>
                <a href="#" th:if="${movie.watched}" th:href="@{${'/user/removeMovie/' + movie.movieID}}" class="btn btn-outline-success mt-3 movie-btn">Remove from watched</a>
            </div>
        </div>

        <form action="#" th:action="@{/rating}" th:object="${ratingForm}" method="post" class="mt-5">
            <div class="input-group">
                <div class="input-group-prepend">
                    <span class="input-group-text h-100">Rate this movie</span>
                </div>
                <input type="number" min="0" max="5" class="form-control rating-input" th:field="*{rating}"></input>
            <input class="btn btn-secondary pe-2 ps-2" type="submit" value="Submit">
            </div>
            <input type="hidden" th:field="*{movieID}">
        </form>


        <div class="comments mt-5">

            <form action="#" th:action="@{/comment}" th:object="${commentForm}" method="post">
                <div class="input-group">
                    <div class="input-group-prepend">
                        <span class="input-group-text h-100">Leave a comment</span>
                    </div>
                    <textarea class="form-control" th:field="*{content}" maxlength="2000"></textarea>
                </div>
                <input type="hidden" th:field="*{movieID}">
                <input class="btn btn-secondary mt-3 pe-5 ps-5" type="submit" value="Post">
            </form>
            

            <div class="comment border-top mt-4 pt-3 d-flex flex-column" th:each="comment : ${movie.comments}">
                <strong class="mb-2" th:text="${comment.user.login}"></strong>
                <p th:text="${comment.content}"></p>
            </div>

        </div>
        
    </div>
    
</body>
</html>